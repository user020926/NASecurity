# NASecurity
 
 ## 概述
 NASecurity 是一款基於 PyQt5 的圖形化工具，用於管理 NAS 設備上的用戶操作。該工具支持以下功能：
 - **用戶密碼變更**
 - **新增用戶**
 - **刪除用戶**
 
 此工具通過 Excel 文件批量處理用戶操作，並提供即時狀態更新及日誌記錄。
 
 ---
 
 ## 功能特性
 - **NAS API 客戶端整合**：使用 `NASClient` 類與 NAS API 交互。
 - **多重驗證支持**：支持雙重驗證碼。
 - **批量處理**：從 Excel 文件中讀取用戶信息進行批量操作。
 - **操作日誌**：記錄成功和失敗的操作，便於排查問題。
 - **GUI 界面**：直觀易用的圖形化界面。
 
 ---
 
 ## 系統需求
 - Python 3.8 或更高版本
 - 以下依賴庫：
   - `requests`
   - `tenacity`
   - `PyQt5`
   - `pandas`
 
 ---
 
 ## 安裝與執行
 
 1. 下載並解壓縮專案檔案。
 2. 進入 `/dist/NASecurity` 目錄，複製 `NASecurity.exe` 路徑。
 3. 建議於桌面建立捷徑，雙擊即可執行。
 
 ---
 
 ## 使用說明
 
 ### GUI 操作流程
 1. **輸入 NAS IP**: 輸入 NAS 設備的 IP 地址，例如 `10.57.78.62`。
 2. **輸入 NAS 埠口**: 輸入 NAS 設備的埠口（Port），例如 `5000`。
 3. **輸入管理員帳號、密碼和雙重驗證碼**: 提供 NAS 管理員的登錄憑據。
 4. **選擇 Excel 文件**: 點擊“瀏覽...”按鈕選擇包含用戶信息的 Excel 文件。
 5. **開始執行**: 點擊“開始執行”按鈕以批量處理用戶操作。
 
 ### Excel 文件格式要求
 Excel 文件需包含以下列：
 - `帳號`: 用戶名（必填）
 - `作業需求`: 操作類型（必填，支持 "密碼變更"、"新增用戶"、"刪除用戶"）
 - 可選列：
 - `工號`
 - `姓名`
 
 ---
 
 ## 程式架構
 
 ### 核心模組
 1. **`api.py`**
 - 提供與 NAS API 的交互功能，包括登錄、檢查用戶是否存在、創建用戶、更改密碼、刪除用戶等功能。
 
 2. **`main.py`**
 - 圖形化界面的主程序，負責文件選擇、狀態更新以及批量處理邏輯。
 
 ### 關鍵類與方法
 | 類名/方法名          | 描述                                     |
 |---------------------|----------------------------------------|
 | `NASClient`         | 與 NAS API 通信的客戶端類。                  |
 | `login()`           | 管理員登錄方法，支持雙重驗證。                   |
 | `user_exists()`     | 檢查指定用戶是否存在。                        |
 | `change_password()` | 更改指定用戶的密碼。                        |
 | `create_user()`     | 創建新用戶並設置初始密碼。                    |
 | `delete_user()`     | 刪除指定用戶。                            |
 | `WorkerThread`      | 從 Excel 文件中讀取並批量執行用戶操作的執行緒。     |
 
 ---
 
 ## 錯誤處理
 程序提供詳細的錯誤信息提示，常見錯誤包括：
 - 缺少必要的 Excel 列。
 - 用戶不存在或已存在。
 - 密碼變更或創建失敗（可能由於 API 返回錯誤代碼）。
 
 ---
 
 ## 開發者信息
 作者：余浩維 
 聯繫方式：haoweiyu0926@gmail.com  
 
 如有問題或建議，請隨時聯繫！
